<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Getting Started with getCPS • getCPS</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Getting Started with getCPS">
<meta property="og:description" content="getCPS">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">getCPS</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/getCPS.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Getting Started with getCPS</h1>
            
      
      
      <div class="hidden name"><code>getCPS.Rmd</code></div>

    </div>

    
    
<p><strong>getCPS</strong> is a package that allows for the fast
fetching of CPS Basic microdata from the Census Bureau’s API. Working
with the Census Bureau’s API can be a bit complicated and tedious and
hence the main motivation behind this package.</p>
<p>In order to get started we need to make sure that getCPS has beeen
installed properly and that it can be loaded</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">getCPS</span><span class="op">)</span></span></code></pre></div>
<p>If you were able to run call above without errors, you should be good
to go! If you need help installing the package, the installation
instrutions can be found at the main page of this website: <a href="../index.html">Click Here</a></p>
<div class="section level2">
<h2 id="pulling-data-for-a-single-state-using-get_cps_data_state">
<strong>Pulling Data for a Single State Using
<code>get_cps_data_state()</code> </strong><a class="anchor" aria-label="anchor" href="#pulling-data-for-a-single-state-using-get_cps_data_state"></a>
</h2>
<p>Data for a single state can be pulled by using
<strong><code><a href="../reference/get_cps_data_state.html">get_cps_data_state()</a></code></strong> and passing a year
range and variable list as vectors, along with a FIPS state code. In
this example we will use my home state of Nevada, whose FIPS state code
is <strong>‘32’</strong>, and we will pull data on labor force
employment status <strong>(PEMLR)</strong> and age
<strong>(PRTAGE)</strong> for each respondent. You must also include a
Census API key in the function, or have one stored in your
<strong><code>.Renviron</code></strong> file as
<strong><code>"CENSUS_API_KEY"</code></strong>. If you don’t have a
Census API key you can obtain one at: <a href="https://api.census.gov/data/key_signup.html" class="external-link">api.census.gov</a></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cps_data</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/get_cps_data_state.html">get_cps_data_state</a></span><span class="op">(</span>year_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2021</span><span class="op">:</span><span class="fl">2023</span><span class="op">)</span>,</span>
<span>                             variable_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'PEMLR'</span>, <span class="st">'PRTAGE'</span><span class="op">)</span>,</span>
<span>                             state_code <span class="op">=</span> <span class="st">"32"</span>,</span>
<span>                             census_api_key <span class="op">=</span> <span class="st">"YOUR CENSUS API KEY"</span><span class="op">)</span></span>
<span><span class="va">cps_data</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Data not available for oct 2023"</span></span>
<span><span class="co">## [1] "Data not available for nov 2023"</span></span>
<span><span class="co">## [1] "Data not available for dec 2023"</span></span></code></pre>
<pre><code><span><span class="co">##    state PEMLR PRTAGE  PWCMPWGT  PWSSWGT       DATE</span></span>
<span><span class="co">## 1     32     5     74 1495.8822 1534.770 2021-01-01</span></span>
<span><span class="co">## 2     32     5     77 1673.2943 1704.638 2021-01-01</span></span>
<span><span class="co">## 3     32     1     29 1762.9311 1763.227 2021-01-01</span></span>
<span><span class="co">## 4     32     1     31 2716.6244 2670.363 2021-01-01</span></span>
<span><span class="co">## 5     32    -1     12    0.0000 1440.297 2021-01-01</span></span>
<span><span class="co">## 6     32    -1      3    0.0000 2040.847 2021-01-01</span></span>
<span><span class="co">## 7     32     5     77 1674.9031 1718.445 2021-01-01</span></span>
<span><span class="co">## 8     32     5     76 1466.8712 1494.348 2021-01-01</span></span>
<span><span class="co">## 9     32     1     32 2161.8659 2152.577 2021-01-01</span></span>
<span><span class="co">## 10    32     1     38 2336.8468 2272.478 2021-01-01</span></span></code></pre>
<p>This should have returned a <strong><code>data.frame</code></strong>
object, with some warnings about months that it was unable to retrieve.
This guide was written on November 1st of 2023, so CPS microdata for the
months of October, November, and December are not yet available, and
hence why we see the warnings. The warnings can be useful in catching
errors. For example sometimes certain variables are only available
during certain time periods, and trying to retrieve variables in a time
period when they are not available will trigger this warning.</p>
<div class="section level3">
<h3 id="understanding-the-output">
<strong>Understanding the output:</strong><a class="anchor" aria-label="anchor" href="#understanding-the-output"></a>
</h3>
<p>Our dataframe <strong><code>cps_data</code></strong> has a couple
columns:
<strong><code>state,PEMLR, PRTAGE, PWCMPWGT, PWSSWGT, and DATE</code></strong>.</p>
<ul>
<li><p>The <strong><code>state</code></strong> column represents the
state FIPS code for the person’s who information is recorded.</p></li>
<li><p><strong><code>PEMLR</code></strong> was one of the variables we
requested, each value represents a unique code that matches the labor
force status for each respondent, later in this guide we will see how we
can convert these codes to labels which will make it easier to
understand the response recorded.</p></li>
<li><p><strong><code>PRTAGE</code></strong> as mentioned earlier is the
age of the respondent, topcoded in order to protect the privacy of the
respondent. For example someone with an age of 97 would be topcoded at
85.</p></li>
<li>
<p><strong><code>PWCMPWGT</code></strong> and
<strong><code>PWSSWGT</code></strong>, are statistical weights for each
response and can be used to estimate aggragate population totals. Even
though the weights were not requested explicitly in our
<strong><code><a href="../reference/get_cps_data_state.html">get_cps_data_state()</a></code></strong> call, the function
has built in logic that automatically pulls the suggested weights for
each of the variables requested.</p>
<ul>
<li>If you would like to know the suggested weight of a variable you can
use the <strong><code><a href="../reference/suggested_weight.html">suggested_weight()</a></code></strong> function. For
example if you wanted to know the suggested weight for
<strong><code>PEMLR</code></strong> you coude use
<strong><code>suggested_weight("PEMLR", year = "2023")</code></strong>.
This will print the suggested weight for
<strong><code>PEMLR</code></strong>, by default
<strong><code>year</code></strong> is set to <strong>“2023”</strong> as
suggested weights rarely differ from year to year in the CPS Basic
microdata.</li>
</ul>
</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/suggested_weight.html">suggested_weight</a></span><span class="op">(</span><span class="st">"PEMLR"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Suggested weight for PEMLR is PWCMPWGT"</span></span></code></pre>
<ul>
<li>
<strong><code>DATE</code></strong> is just a column that keeps track
of which month the response was recorded. This column is already of data
type <date> making it easy to sort, filter and manipulate data based on
specific dates.</date>
</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="using-get_cps_data_all_states-to-obtain-data-for-all-states">
<strong>Using <code>get_cps_data_all_states()</code> to Obtain Data
for All States</strong><a class="anchor" aria-label="anchor" href="#using-get_cps_data_all_states-to-obtain-data-for-all-states"></a>
</h2>
<p>In some cases, you might be interested in pulling CPS data for all
states. This can be achieved using the
<strong><code><a href="../reference/get_cps_data_all_states.html">get_cps_data_all_states()</a></code></strong> function.
Similar to <code><a href="../reference/get_cps_data_state.html">get_cps_data_state()</a></code>, you need to pass the year
range and the variables you are interested in.</p>
<p>If you want to filter the data to include only specific states, you
can use the <code>state_filter</code> argument, passing it as a
character vector of state FIPS codes. If you leave
<code>state_filter</code> as FALSE, the function will return data for
all states.</p>
<p>Remember to provide your Census API key if you haven’t set it in your
<strong><code>.Renviron</code></strong> file.</p>
<div class="section level3">
<h3 id="example---fetching-data-for-all-states">Example - Fetching Data for All States<a class="anchor" aria-label="anchor" href="#example---fetching-data-for-all-states"></a>
</h3>
<p>The following example demonstrates how to fetch data for the years
2022 and 2023, including variables related to the respondent’s sex
(<strong><code>PESEX</code></strong>) and age
(<strong><code>PRTAGE</code></strong>). We will retrieve data for all
states without filtering.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">all_states_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_cps_data_all_states.html">get_cps_data_all_states</a></span><span class="op">(</span>year_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2022</span>, <span class="fl">2023</span><span class="op">)</span>,</span>
<span>                                           variable_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PESEX"</span>, <span class="st">"PRTAGE"</span><span class="op">)</span>,</span>
<span>                                           census_api_key <span class="op">=</span> <span class="st">"YOUR CENSUS API KEY"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">all_states_data</span><span class="op">)</span></span></code></pre></div>
<p>The output will be a <strong><code>data.frame</code></strong> with
the requested data. If you wish to fetch data only for specific states,
you can specify them as follows:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">specific_states_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_cps_data_all_states.html">get_cps_data_all_states</a></span><span class="op">(</span>year_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2022</span>, <span class="fl">2023</span><span class="op">)</span>,</span>
<span>                                                variable_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PESEX"</span>, <span class="st">"PRTAGE"</span><span class="op">)</span>,</span>
<span>                                                state_filter <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"32"</span>, <span class="st">"06"</span><span class="op">)</span>, <span class="co"># Example for Nevada and California</span></span>
<span>                                                census_api_key <span class="op">=</span> <span class="st">"YOUR CENSUS API KEY"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">specific_states_data</span><span class="op">)</span></span></code></pre></div>
<p>The output will be similar to that generated by <a href="#pulling-data-for-a-single-state-using-get_cps_data_state"><code>get_cps_data_state()</code></a>,
with the only difference being that data will be generated for all
states and not just one. Remember, working with data covering all states
can be quite extensive and might require considerable computational
resources depending on the volume of data and the capacity of your
system, if you encounter errors due to memory allocation, breaking up
the data retrieval into chunks is recommended.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Antonio Solorio Ramirez.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
